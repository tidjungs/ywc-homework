<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<canvas id="canvas"></canvas>
	
	<style type="text/css">
		* {
			margin: 0;
			padding: 0;
		}

		body {
			width: 100%;
			height: 100%;
		}

		#canvas {
			background-color: black;
			display: block;
			width: 100%;
		}
	</style>

	<script type="text/javascript">
		let canvas = document.getElementById('canvas'),
   	context = canvas.getContext('2d');
   	let targetPos = {x:0, y:0};

   	const DIRECTION = {
   		leftDown: -2.25,
   		down: -1.5,
   		rightDown: 0.75,
   		left: 0,
   		rightUp: -0.75,
   		up: 1.5,
   		leftUp: 2.25,
   		right: 3,
   	}

   	let pacman = {
   		x: 0,
   		y: 0,
   		radius: 40,
   		radiant: 1,
   		time: 80,
   		dir: DIRECTION.left
   	}

   	let tick = 0;

    window.addEventListener('resize', resizeCanvas, false);
		
		canvas.addEventListener('mousemove', function(e) {
        targetPos = getMousePos(canvas, e);

    }, false);

   function getMousePos(canvas, e) {
      let rect = canvas.getBoundingClientRect();
      return {
        x: e.clientX - rect.left,
        y: e.clientY - rect.top
      };
    }

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;     
    }

    function updatePacmanDirection() {
    	if (pacman.x == targetPos.x) {
    		if (pacman.y < targetPos.y) {
    			pacman.dir = DIRECTION.up;
    		} else if (pacman.y > targetPos.y) {
    			pacman.dir = DIRECTION.down;
    		}
    	} else if (pacman.y == targetPos.y) {
    		if (pacman.x < targetPos.x) {
    			pacman.dir = DIRECTION.left;
    		} else if (pacman.x > targetPos.x) {
    			pacman.dir = DIRECTION.right;
    		}
    	} else {
    		if (pacman.x < targetPos.x && pacman.y < targetPos.y) {
    			pacman.dir = DIRECTION.rightDown;
    		} else if (pacman.x < targetPos.x && pacman.y > targetPos.y) {
    			pacman.dir = DIRECTION.rightUp;
    		} else if (pacman.x > targetPos.x && pacman.y < targetPos.y) {
    			pacman.dir = DIRECTION.leftUp;
    		} else if (pacman.x > targetPos.x && pacman.y > targetPos.y) {
    			pacman.dir = DIRECTION.leftDown;
    		}
    	}
    }

    function updatePacmanPosition() {
    	if (pacman.x != targetPos.x) 
				pacman.x += pacman.x < targetPos.x ? 1 : -1;
			if (pacman.y != targetPos.y)
    		pacman.y += pacman.y < targetPos.y ? 1 : -1;
    }

    function updateTick() {
    	tick += tick < pacman.time ? 1 : -tick;
    }

    function drawStuff() {
    	canvas.width = canvas.width;
			context.beginPath();
    	context.fillStyle = 'yellow';
			let proportion = -Math.cos( tick / pacman.time * 2 * Math.PI ) / 2 + .5;
			context.moveTo(pacman.x, pacman.y);
    	context.arc(pacman.x, pacman.y, pacman.radius, pacman.radiant * proportion + pacman.dir, Math.PI * 2 - pacman.radiant * proportion + pacman.dir);
    	context.fill();
    	updatePacmanPosition();
    	updatePacmanDirection();
    	updateTick();
		}

		resizeCanvas();  
    setInterval(() => {
		 drawStuff(); 
		}, 1);

	</script>
</body>
</html>